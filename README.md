This is the logic part of the high-level filter in the streaming daq system.
